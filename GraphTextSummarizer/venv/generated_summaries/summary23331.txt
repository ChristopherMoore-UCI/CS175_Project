And the transitional government was wracked by a power struggle between Prime Minister Nur Hassan Hussein and President Abdullahi Yusuf, who resigned in December. Islamist militants took almost full control of Mogadishu on Thursday, less than 24 hours after Ethiopian troops withdrew from Somalia's capital, a witness reported. Efforts to replace the Ethiopians with an African Union-led peacekeeping mission faltered as the violence worsened, and heavy fighting in Mogadishu and other cities drove hundreds of thousands from their homes. Ethiopia invaded Somalia in December 2006 to install a U.N.-backed transitional government in Mogadishu after a decade and a half of near-anarchy. The invasion had the blessing of the United States, which accused the Islamic Courts Union that captured Mogadishu earlier that year of harboring fugitives from al Qaeda.